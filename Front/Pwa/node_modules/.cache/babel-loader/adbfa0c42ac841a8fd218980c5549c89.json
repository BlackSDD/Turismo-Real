{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jesus/Documents/GitHub/Turismo-Real/Front/Pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/jesus/Documents/GitHub/Turismo-Real/Front/Pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/jesus/Documents/GitHub/Turismo-Real/Front/Pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component,useState,useEffect}from'react';import ReactDOM from'react-dom';import{useHistory}from'react-router-dom';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var PayPalButton=window.paypal.Buttons.driver(\"react\",{React:React,ReactDOM:ReactDOM});function PaypalCheckout(){// const [price, setPrice] = useState(0);\n// let history = useHistory();\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),pago=_useState2[0],setPago=_useState2[1];var precio=pago;var id_rva=sessionStorage.reserva;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),informeR=_useState4[0],setInformeR=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),count=_useState6[0],setCount=_useState6[1];var urlId={id_reserva:id_rva};var dolar=Math.round(precio/830);var _createOrder=function createOrder(data,actions){return actions.order.create({purchase_units:[{amount:{value:dolar}}]});};useEffect(function(e){// e.preventDefault();\ngetMontoPago(id_rva);},[]);var getMontoPago=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('http://localhost:4000/API/pago/montoPago/'+id);case 2:res=_context.sent;setPago(res.data);console.log(res.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getMontoPago(_x){return _ref.apply(this,arguments);};}();var _onApprove=function onApprove(data,actions){return actions.order.capture(handlePay());};function handlePay(e){console.log(\"Pago recibido\");getInformeRes(urlId);setCount(true);}// useEffect(() => {\n//     getInformeRes(urlId);\n// },[]);\nvar getInformeRes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('http://localhost:4000/API/informeResDet/',urlId);case 2:res=_context2.sent;setInformeR(res.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getInformeRes(){return _ref2.apply(this,arguments);};}();console.log({informeR:informeR});if(count===false){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"El monto a pagar es \",dolar,\" \"]}),/*#__PURE__*/_jsx(PayPalButton,{createOrder:function createOrder(data,actions){return _createOrder(data,actions);},onApprove:function onApprove(data,actions){return _onApprove(data,actions);}}),/*#__PURE__*/_jsx(\"h1\",{children:informeR.Id_reserva})]});}else{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pago recibido\"}),informeR.map(function(e){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:e.Cliente}),/*#__PURE__*/_jsx(\"p\",{children:e.FechaReserva}),/*#__PURE__*/_jsx(\"p\",{children:dolar}),/*#__PURE__*/_jsx(\"p\",{children:pago})]});})]});}}export default PaypalCheckout;","map":{"version":3,"sources":["C:/Users/jesus/Documents/GitHub/Turismo-Real/Front/Pwa/src/components/Layouts/PaypalCheckout.js"],"names":["React","Component","useState","useEffect","ReactDOM","useHistory","axios","PayPalButton","window","paypal","Buttons","driver","PaypalCheckout","pago","setPago","precio","id_rva","sessionStorage","reserva","informeR","setInformeR","count","setCount","urlId","id_reserva","dolar","Math","round","createOrder","data","actions","order","create","purchase_units","amount","value","e","getMontoPago","id","get","res","console","log","onApprove","capture","handlePay","getInformeRes","post","Id_reserva","map","Cliente","FechaReserva"],"mappings":"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","sourcesContent":["import React, {Component, useState, useEffect} from 'react';\r\nimport ReactDOM  from 'react-dom';\r\nimport { useHistory} from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst PayPalButton = window.paypal.Buttons.driver(\"react\", { React, ReactDOM });\r\n\r\nfunction PaypalCheckout () {\r\n    // const [price, setPrice] = useState(0);\r\n    // let history = useHistory();\r\n    const [pago, setPago] = useState([]);\r\n    const precio = pago;\r\n    const id_rva = sessionStorage.reserva;\r\n    const [informeR, setInformeR] = useState([])\r\n    const [count, setCount] = useState(false);\r\n\r\n    let urlId = {\r\n        id_reserva: id_rva\r\n    }\r\n\r\n    let dolar = Math.round(precio/830);\r\n\r\n    const createOrder = (data, actions) => {\r\n        return actions.order.create({\r\n            purchase_units: [{\r\n                amount: {\r\n                value: dolar,\r\n                },\r\n            }]\r\n        });\r\n    };\r\n\r\n    useEffect((e)=>{\r\n        // e.preventDefault();\r\n            getMontoPago(id_rva);\r\n    },[]);\r\n\r\n    const getMontoPago = async (id) =>{\r\n        const res = await axios.get('http://localhost:4000/API/pago/montoPago/' + id)\r\n        setPago(res.data);\r\n        console.log(res.data);\r\n    }\r\n    \r\n    const onApprove = (data, actions) => {\r\n        return actions.order.capture(handlePay());\r\n    };\r\n\r\n    function handlePay(e){\r\n        console.log(\"Pago recibido\");\r\n        getInformeRes(urlId);\r\n        setCount(true);\r\n    }\r\n    \r\n    // useEffect(() => {\r\n    //     getInformeRes(urlId);\r\n    // },[]);\r\n\r\n    const getInformeRes = async () => {\r\n        const res = await axios.post('http://localhost:4000/API/informeResDet/', urlId )\r\n        setInformeR(res.data)\r\n    }\r\n\r\n    console.log({informeR})\r\n\r\n    if(count===false){\r\n        return( \r\n            <div>\r\n                <h1>El monto a pagar es {dolar} </h1>\r\n                <PayPalButton\r\n                    createOrder={(data, actions) => createOrder(data, actions)}\r\n                    onApprove={(data, actions) => onApprove(data, actions)}\r\n                />\r\n                <h1>{informeR.Id_reserva}</h1>\r\n            </div>\r\n        );\r\n    }\r\n    else {\r\n    return(\r\n        <div>\r\n            <h1>Pago recibido</h1>\r\n            {\r\n                informeR.map(e =>\r\n                    <div>\r\n                        <p>{e.Cliente}</p>  \r\n                        <p>{e.FechaReserva}</p> \r\n                        <p>{dolar}</p>\r\n                        <p>{pago}</p>\r\n                    </div>\r\n                )\r\n            }\r\n        </div>\r\n    );\r\n    }\r\n}\r\n\r\nexport default PaypalCheckout  \r\n"]},"metadata":{},"sourceType":"module"}